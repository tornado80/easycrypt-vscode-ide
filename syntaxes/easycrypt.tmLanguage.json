{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "EasyCrypt",
  "scopeName": "source.easycrypt",
  "fileTypes": ["ec", "eca"],
  "patterns": [
    { "include": "#comments" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#pragmas" },
    { "include": "#dangerous-keywords" },
    { "include": "#proof-control" },
    { "include": "#bytac-keywords" },
    { "include": "#tactical-keywords" },
    { "include": "#tactic-keywords" },
    { "include": "#global-keywords" },
    { "include": "#internal-keywords" },
    { "include": "#prog-keywords" },
    { "include": "#builtin-functions" },
    { "include": "#types" },
    { "include": "#operators" },
    { "include": "#punctuation" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.block.easycrypt",
          "begin": "\\(\\*",
          "end": "\\*\\)",
          "patterns": [
            { "include": "#comments" }
          ]
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.easycrypt",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.easycrypt",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.real.easycrypt",
          "match": "(?<![\\w'])-?\\d+\\.\\d+([eE][+-]?\\d+)?\\b"
        },
        {
          "name": "constant.numeric.hex.easycrypt",
          "match": "\\b0[xX][0-9a-fA-F]+\\b"
        },
        {
          "name": "constant.numeric.octal.easycrypt",
          "match": "\\b0[oO][0-7]+\\b"
        },
        {
          "name": "constant.numeric.binary.easycrypt",
          "match": "\\b0[bB][01]+\\b"
        },
        {
          "name": "constant.numeric.integer.easycrypt",
          "match": "(?<![\\w'])-?\\d+\\b"
        }
      ]
    },
    "pragmas": {
      "comment": "Pragma directives: highlight keyword and its arguments distinctly",
      "patterns": [
        {
          "name": "meta.directive.pragma.easycrypt",
          "begin": "\\bpragma\\b",
          "beginCaptures": {
            "0": { "name": "keyword.other.pragma.easycrypt" }
          },
          "end": "\\.",
          "endCaptures": {
            "0": { "name": "punctuation.terminator.easycrypt" }
          },
          "patterns": [
            {
              "name": "meta.directive.pragma.arguments.easycrypt",
              "match": "[^\\.]+"
            }
          ]
        }
      ]
    },
    "dangerous-keywords": {
      "patterns": [
        {
          "name": "invalid.deprecated.dangerous.easycrypt",
          "match": "\\b(admit|admitted)\\b"
        }
      ]
    },
    "proof-control": {
      "patterns": [
        {
          "name": "keyword.control.proof.easycrypt",
          "match": "\\b(proof|qed|save|abort)\\b"
        }
      ]
    },
    "bytac-keywords": {
      "comment": "Tactics that close goals - highlighted distinctly",
      "patterns": [
        {
          "name": "keyword.control.bytac.easycrypt",
          "match": "\\b(exact|assumption|smt|by|reflexivity|done)\\b"
        }
      ]
    },
    "tactical-keywords": {
      "comment": "Tacticals for combining tactics",
      "patterns": [
        {
          "name": "keyword.control.tactical.easycrypt",
          "match": "\\b(try|first|last|do|strict|expect)\\b"
        }
      ]
    },
    "tactic-keywords": {
      "comment": "Proof tactics",
      "patterns": [
        {
          "name": "support.function.tactic.easycrypt",
          "match": "\\b(beta|iota|zeta|eta|logic|delta|simplify|congr|change|split|left|right|case|pose|cut|have|suff|elim|clear|apply|rewrite|rwnormal|subst|progress|trivial|auto|idtac|move|modpath|field|fieldeq|ring|ringeq|algebra|transitivity|symmetry|seq|wp|sp|sim|skip|call|ecall|rcondt|rcondf|swap|cfold|rnd|pr_bounded|bypr|byphoare|byequiv|fel|conseq|exfalso|inline|alias|fission|fusion|unroll|splitwhile|kill|eager)\\b"
        }
      ]
    },
    "global-keywords": {
      "comment": "Global/structural keywords",
      "patterns": [
        {
          "name": "keyword.control.directive.easycrypt",
          "match": "\\b(axiom|axiomatized|lemma|realize|goal|end|import|export|include|local|declare|hint|nosmt|module|of|const|op|pred|inductive|notation|abbrev|require|theory|abstract|section|type|class|instance|print|search|as|Pr|clone|with|rename|prover|timeout|why3|dump|remove|Top|Self)\\b"
        }
      ]
    },
    "internal-keywords": {
      "comment": "Internal/debugging keywords",
      "patterns": [
        {
          "name": "keyword.other.internal.easycrypt",
          "match": "\\b(time|undo|debug)\\b"
        }
      ]
    },
    "prog-keywords": {
      "comment": "Program logic keywords",
      "patterns": [
        {
          "name": "keyword.control.easycrypt",
          "match": "\\b(forall|exists|fun|lambda|glob|let|in|with|match|var|proc|call|if|then|else|elif|while|assert|return|res|equiv|hoare|phoare|pr|cnv|lossless|islossless|async)\\b"
        }
      ]
    },
    "builtin-functions": {
      "comment": "Common built-in predicates/functions that appear in examples",
      "patterns": [
        {
          "name": "support.function.builtin.easycrypt",
          "match": "\\b(is_lossless|is_uniform|is_full)\\b"
        }
      ]
    },
    "types": {
      "comment": "Built-in types",
      "patterns": [
        {
          "name": "storage.type.easycrypt",
          "match": "\\b(bool|int|real|string|unit|list|map|fmap|set|fset|distr|option|xint|addr)\\b"
        },
        {
          "name": "constant.language.boolean.easycrypt",
          "match": "\\b(true|false)\\b"
        },
        {
          "name": "constant.language.unit.easycrypt",
          "match": "\\b(tt)\\b"
        },
        {
          "name": "constant.language.option.easycrypt",
          "match": "\\b(None|Some)\\b"
        },
        {
          "name": "constant.language.list.easycrypt",
          "match": "\\b(Nil|Cons)\\b"
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.logical.easycrypt",
          "match": "/\\\\|\\\\/|=>|<=>|!"
        },
        {
          "name": "keyword.operator.comparison.easycrypt",
          "match": "<=|>=|<>|<|>|="
        },
        {
          "name": "keyword.operator.arithmetic.easycrypt",
          "match": "\\+|-|\\*|/|%|\\^"
        },
        {
          "name": "keyword.operator.assignment.easycrypt",
          "match": "<-|:="
        },
        {
          "name": "keyword.operator.misc.easycrypt",
          "match": "\\$|\\||&|@|#|~|::|\\.\\.|\\.\\[|\\]\\."
        },
        {
          "name": "keyword.operator.arrow.easycrypt",
          "match": "->|~>"
        }
      ]
    },
    "punctuation": {
      "patterns": [
        {
          "name": "punctuation.terminator.easycrypt",
          "match": "\\."
        },
        {
          "name": "punctuation.separator.easycrypt",
          "match": ",|;"
        },
        {
          "name": "punctuation.definition.parameters.easycrypt",
          "match": "\\(|\\)"
        },
        {
          "name": "punctuation.definition.block.easycrypt",
          "match": "\\{|\\}"
        },
        {
          "name": "punctuation.definition.list.easycrypt",
          "match": "\\[|\\]"
        }
      ]
    }
  }
}
